neural network interpretation fine grained textual summarization pei guo connor anderson kolton pearson ryan farrell brigham young university p e s v c s c v v x r abstract recent visualization based neural network interpretation zhou et al selvaraju et al algorithms suffer lacking semantic level information hindering plication tasks like ne grained recognition introduce novel task interpreting classication models textual summarization explanation tence consists image level visual attributes important decision making found bayesian inference gorithm process amounts mimicking humans ligence summarize content image central algorithm lter level attribute probability density tion learned posterior probability input images latent variables generate textual explanation dataset visual attributes extracted image captions demonstrate accuracy proposed gorithm devise experiments attribute grounding attribute based image retrieval provide qualitative quantitative analysis textual marization help understanding network failure terns provide clues improvements grained recognition code available acceptance introduction given convolutional network interested knowing features learned making classication sions despite tremendous success computer vision krizhevsky sutskever hinton simonyan zisserman et al tasks deep neural work models commonly viewed black boxes difculty neural network understanding mainly lies end end learning feature extractor sub network classier sub network contain millions parameters debugging condent network assigns wrong class label image high bility extremely difcult true versarial noise goodfellow shlens szegedy added deliberately guide network wrong sion desirable textual output plaining features responsible triggering error like intelligent compiler grammar bug code network interpretation crucial tasks copyright association advancement articial intelligence www aaai org rights reserved figure comparison visualization based tion zhou et al interpretation summarization proposed approach semantic details useful analyzing incorrect predictions involving humans like autonomous driving medical age analysis important distill edge learned deep models represent easy understand way fine grained recognition concerns problem criminating visually similar sub categories like ferent species gulls different versions bmw cars humans usually good tasks like attribute prediction keypoint annotation image captioning usually nd ne grained recognition extremely hard proper training network interpretation useful ne grained recognition nd network s failure terns educate humans network thinks informative features worth noting proposed algorithm constrained ne grained recognition equally effective applied general image dataset given accurate image level attribute annotations current network interpretation largely based algorithms like cam zhou et al cam selvaraju et al work highlighting region image s important decision making figure visualization inefcient localizing discriminative parts providing semantic formation tasks like ne grained recognition humans hand justify conclusions ural language instance knowledgeable person ing photograph bird think anna s hummingbird straight bill rose pink throat crown s broad tailed bird later lacks red crown kind prediction carolina wrenground truth house wrencam visualizationthis carolina wren brown black crown white breast white eyebrow short beakthis house wren brown crown white eyebrow long tail pointy long beaktextual summarization textual description carries rich semantic information easily understandable natural language logical medium ground interpretation deep convolutional models paper propose novel task summarizing decision making process deep convolutional models ne grained textual descriptions figure example specic aim nd list visual tributes network bases decision algorithm dependent image level visual attributes obtained ground truth annotation image tion decomposition central algorithm method associate nal convolutional layer lter visual tributes represents activating patterns discover experiment model lters nt necessarily activate narrow beam patterns mulate relationship filter attribute pair conditional multinomial probability distribution tribute likely represent lter images attribute better activate lter attributes directly involved network introduce images hidden variables based lter attribute probability density function p rank attributes weighting lter attribute class specic weights step lar cam zhou et al grad et al nal textual explanation template sentence attributes supportive evidence order demonstrate accuracy proposed gorithm devise product tasks sanity checks rst task visual attribute grounding specically localize sub region image related query attribute note task weakly supervised gory labels achieved linear combination nal layer feature map according lter attribute second experiment visual attribute based age retrieval query attribute obtain list date images containing attribute decent results tasks serve strong indicator core algorithm works properly direct application proposed textual explanation algorithm work network debugger ate error messages network prediction wrong summarize major failure patterns grained dataset rst common failure pattern network fails identify true native features network confused small inter class variation large intra class variation second failure pattern network robust image perturbations color distortion low image quality ure pattern caused incorrect human labels roughly annotation errors cub main contributions paper summarized follows propose novel task network interpretation textual summarization identify lter attribute core problem propose bayesian inference framework learn devise tasks automatic quantitative evaluation figure lter attribute association nd ping abstract functional space semantic tribute space b composite lter function dinate transformed dened attribute space c activation images lter yellow head detector learned p demonstrating accuracy proposed algorithm employ proposed framework network ging ne grained recognition unveil common ure patterns useful improvement related works network interpretation main approaches network interpretation literature lter level pretation erhan et al szegedy et al dran vedaldi nguyen yosinski clune google nguyen et al bau et al zhou et al yosinski et al springenberg et al zeiler fergus holistic level interpretation monyan vedaldi zisserman zhou et al selvaraju et al goal lter level interpretation understand visualize features specic rons learn s easy directly visualize rst volutional layer lter weight sense patterns detect makes little sense directly visualize deeper layer lter weights act complex ite functions lower layers operations early examples lter level understanding include nding maximally tivated input patches zeiler fergus ing guided propagation gradients springenberg et al works nguyen yosinski clune try synthesize visually pleasant preferred input image neuron propagation image space nguyen et al applies generator network ate images conditioned maximally activating certain layer neurons plug play paper nguyen et al extends nguyen et al introduce ized adversarial learning framework lter guided image generation network dissection bau et al measures interpretability neuron annotating predened attributes like color texture zhang et al proposes represent image content structure knowledge graph attempts holistic summarization mainly focus sualizing important image subregions weighting nal convolutional layer feature maps examples include cam zhou et al grad cam selvaraju et al visualization based method red faceyellow bellyabstract functional spaceattribute spaceyellow crownyellow headorange crowninput imageactivation functiontop activation images figure textual explanations generated method vides coarse level information remains hard itively know feature pattern network learned detect importantly holistic heat map tation insufcient justify network favors certain classes attentional maps different classes overlap heavily figure ple vqa image caption tasks combine text generation visual explanation include image captioning visual question answering vqa sounds like similar task image captioning farhadi et al fundamentally different image captioning usually fully supervised manner goal generating caption describes general content image textual interpretation task aims loyally reects knowledge learned classication model pervised way visual question answering antol et al task requires understanding image ing textual questions task viewed special case unsupervised vqa focuses specically questions model think image longs class x text grounding rohrbach et al language vision task tries locate object image referred given text phrase note dricks al denes task similar explain justify classication model model learned supervised manner explanations generated lstm network implicitly depends nal feature maps essentially image captioning task generates captions class discriminative mation method unsupervised rely black box network generate descriptions fine grained recognition fine grained recognition aims discriminate subcategories like species birds dogs different model cars aircrafts difculty ne grained recognition lies tremely large intra class variance small inter class ance representative works include bilinear pooling lin roychowdhury maji computes outer product nal layer feature maps attention based els sermanet frome real works focusing tention discriminative parts image object based models zhang et al works decomposing age features readily compared fine grained recognition special usually performs better non expert humans s interesting unveil knowledge learns decision making bayesian inference framework fundamental step network interpretation interested representing network lter representing activation patterns terms visual attributes constructing paired filter attribute dataset unrealistic cause lter composite function dened concept concrete examples instead propose aging shelf image attribute annotations contain rich textual references visual concepts tuition lter attribute association simple model lters represented images strongly activate corresponding image attributes high probability representing activated lter joint consensus textual attributes dataset serve good indicator lter pattern provided network properly trained formally composite lter function takes age input produces feature map strength dicates existence certain patterns lter tation task aims nd mapping abstract tional space semantic visual attribute space figure help image level attributes consider ordinate transformation operation transforms input lter function image image attributes attribute probability distribution obeys multinomial tion approximated attribute probability density function key component proposed algorithm american pipit short beak yellow white breast brown crown yellow throat b eared grebe black crown long neck black head red eye white throat c groove billed ani black head thick pointy black beak black crown d parakeet auklet black red crown black head white breast black throat e philadelphia vireo yellow breast grey head yellow throat short beak white eyebrow f great grey shrike white breast black crown white throat black beak black cheek patch filter attribute probability density function note f n group model lters paper interested nal convolutional layer lters input fully connected layer denote x m set input ages lter s output naturally written f feature map lter activation consider els et al huang et al global pooling layer fully connected layer fully connected layer produces class label predictions c o weight matrix w list textual attributes t l attached image loosely ti ti contained image s attribute list propose bayesian inference framework learn probability visual attributes represent lter terns lter attribute probability sity function p formulated posterior probability prior probability visual attribute tj consider relative importance attributes carry different information entropy example small bird information orange beak appears text corpora corresponds important image feature employ normalized tf idf feature attribute prior measures likelihood attribute tj activating lter fi attributes directly involved neural network introduce input images latent variables measures likelihood image xk attribute tj reason lter fi s activation assume fi conditionally independent tj given xk normalization function global pooling layer output strength feature map measures likely image activate lter proximation neglects fact image activates lter feature map favors certain attributes ers example highlights head area bird attributes related head beak eyes assigned higher probabilities attributes related wings feet naive approximation signs equal probability visual attribute imation actually works decently joint consensus input images highlights true attributes suppresses false ones way associate spatial distribution feature map corresponding visual attribute ploit forms annotations like keypoints mentation feature map overlaps highly certain segmentation higher probability assigned corresponding visual attributes approach dependent additional forms human annotations hinders generalization proposed algorithm s paper measures likelihood tj attribute image xk takes tj attribute list tj xk aggregating filter attribute p s holistic tion help lter attribute gure features network learned image cation problem formulated probability visual attributes given fact network produces certain class label certain input image introduce nal convolutional layer lters hidden variables cm xi cm cm cm cm probability tj reason network predicts xi class cm assume tj tionally independent cm given lter attribute cm measures importance lter fk decision making process cm wm k normalization function wm k weight classier weight matrix connecting lter fk class prediction cm global pooling layer c image class attribute p generate natural sentence describe network decision making process image class attribute s popular employ recurrent model sentence generation task faithfully reect internal features learned network introducing network result uncertainty instead propose simple template based method lowing form class attribute attribute attribute n consider attributes sentence shorter precise steps taken merge adjectives related nouns important aspect model interpretation compare reasons certain choices opposed e network thinks input belongs class ci instead cj easily summarize relation difference predictions comparing image class attribute p example birds long beaks class ci favors green crown class cj tends blue crown example shown figure explain away mechanism lter attribute obeys multinomial distribution necessarily tivate narrow beam features instead behaves like multi modal gaussian distribution vates totally different features example lter fi likely detect blue head black head high probability interpretability lter suffer multi modal characteristic cially true image description task hard know exactly feature activates lter tasks experiments provide qualitative tive analysis experiment section potential plications left future work figure example caption annotations cub tracted visual attributes highlighted observe lters act plimentary way help explain away probability related patterns instance lter fk activates blue head black head lters activate probability blue head high fi activates black head ble pattern joint consensus lters makes generated explanation reasonable class level description given lter attribute s interested knowing features important class task formulated probability visual attributes given fact network predicting image class cm cm lter attribute sume tj conditionally independent cm given f measure importance lter class ci simply k normalization function wm k weight classier weight matrix connecting lter fk class prediction cm different image class attribute p class level description weights attributes based classier weight lter attribute difcult tasks like ne grained recognition deep models perform better non expert users knowledge distilled class level description potentially teach users discriminate challenging domains applications textual summarization order demonstrate accuracy learned p s devise product tasks visual attribute grounding attribute based image retrieval sanity checks success tasks serve strong dicator effectiveness method direct cation proposed textual summarization algorithm understand network s failure patterns provide gestions future improvement validate proposed figure unnormalized lter attribute s activation images visual attribute grounding given query visual tribute like know image region refers lter attribute help task suppose ti visual attribute associated image xj formulate image region interests roi y linear combination nal convolutional layer feature maps y k n normalization function k tuitively weight lter responses according lter attribute p task weakly supervised image bels ground truth roi phrase pairs learn algorithm fails learn accurate lter attribute expect grounded region accurate attribute based image retrieval like able search database images textual attribute queries return images match example like nd images birds white head black throat image class attribute p provides simple method rank images based probability containing desired attributes given query visual tribute simply return images contains query generated textual explanation sentence network debugging network produces wrong prediction like understand reason ne grained dataset generate textural summarization failure cases explain network favors wrong prediction instead ground truth prediction unveil common failure patterns network helpful network improvement experiments demonstrate effectiveness algorithm ne grained dataset wah et al training images testing images image level visual attributes obtained directly binary tribute annotation image caption reed et al bird long black bill red cheek patches grey head black spotted feathers bird red cheek patch brown grey head grey neck black throat light brown coverts black specks multicolored bird black spots red malar strip long pointed bill orange billlong white necklong neckblack crownwhite necklarge orange beaklong billlong orange beakwhite throatlong yellow breastred chestbright red breastblack headred throatblack crownred crownblack beakwhite beakwhite bill decomposition choose second route age captions contain rich diverse visual attributes better suited purpose example shown figure use convolutional model trained imagenet deng et al ne tuned cub use bounding box cropped images reduce ground noise figure attribute based image retrieval row shows attribute query left followed ranked results terms probability image tains query attributes visual attribute extraction rst extract visual tributes image captions follow pipeline word tokenization speech tagging noun phrase chunking simplicity consider adjective noun type attributes recursion end dependent attributes term frequency tf phrase t computed number occurrences t captioning le cub image caption le different captions inverse document frequency idf d n total number les d number les containing phrase filter attribute p d f textual summarization examples lter attribute s figure clear connection activated images ranked attributes validates idea tual visual attributes represent lter pattern examples generated textual explanations image sication figure generated nations capture class discriminative information present images visual attribute grounding figure amples query attributes generated raw heatmaps indicating image visual attribute refers column denotes different visual attribute heatmap shown transparency map indicates region highest activation image tively proposed approach reasonably good lighting region interests visual attributes highly correlated points quantitatively measure performance posed visual attribute grounding algorithm compare generated heatmap max value location ground truth keypoint locations present pck percentage rect keypoints score frequent visual attributes corresponding keypoint annotations means predicted location distance object size ground truth keypoint note visual attribute grounding supervised keypoints optimized keypoint detection compare baseline methods randomly assign location attribute baseline similar proposed method lter attribute constant attributes table learned p forms better baseline methods demonstrating accuracy proposed algorithm table attribute grounding random constant p proposed attribute based image retrieval figure amples attribute based image search text based tributes shown images ranked high low probability image contains query attributes results encouraging image clearly tains query attributes measure performance attribute based image trieval comparing ground truth caption based retrieval attributes seen table note numbers approximations ground truth caption nt necessarily contain true attribute image fact method performs better random trieval demonstrates accuracy underlying class attribute p figure examples text grounding column resents different attribute examples shown heatmaps indicating region attribute present table image retrieval measurements recall true negative accuracy network debugging gure major patterns network failure textual summarization rst example tree sparrow incorrectly nized chipping sparrow network enly thinks long tail discriminative feature failing identify effective features discrimination common source errors dataset ne grained classication main challenge identify white eyebrowwhite headblack breastyellow headyellow breast figure analysis network failures network debugging row represents network failure incorrectly predicted class label left right row shows query image canonical images ground truth incorrectly predicted classes explanations classes box rst row provides background differences tree sparrows chipping sparrows tive features visually similar classes differences subtle localized small parts pect explanations incorrectly classied images tain noisy features accurate second example shows seaside sparrow mistakenly recognized blue grosbeak textual explanations ascertain low image quality mistakenly activates lters correspond blue head blue crown underlying source error complex generalization ability network limited small perturbations image result unwanted lter responses failures imply critical importance improving network robustness case network predicts image yellow warbler ground truth label bellied flycatcher according bird expert network got correct ground truth label error work correctly identies yellow crown yellow head obvious features yellow warbler errors like surprising according van horn et al roughly class labels cub dataset incorrect mistake shown figure false negative indicates classier learn assign correct weights discriminative features quantitatively measure accuracy generated planations compute sentence bleu scores measure similarity generated sentence ground truth caption annotations table erally explanations accurate correctly ed images textual explanation nt directly optimized mimic image caption annotations table blue score correct wrong overall conclusion paper propose novel task network tion generates textual summarization justifying work decision use publicly available captioning tions learn filter attribute relationships unsupervised manner approach builds intuition lter responses strongly correlated specic mantic patterns leveraging joint consensus attributes activated images generate level attribute p enables holistic level planations combining visual attributes natural tence demonstrate accuracy proposed rithm visual attribute grounding attribute based age retrieval employ textual explanation network debugging tool summarize common failure patterns ne grained recognition future work includes experiments additional models datasets algorithm generalized ing weaker class level caption annotations word bedding methods mikolov et al american tree sparrows left rufous stripe eye chipping sparrows right black tree sparrows spot middle breast bicolored bill chipping sparrows chipping sparrow long tail white breast short beak brown red crown tree sparrow black throat white breast short beak brown red crown seaside sparrow brown yellow crown black throat yellow eyebrow short beakthis blue grosbeak brown blue crown black throat short beak blue headthis yellow bellied flycatcher bright yellow breast red crown gray headthis yellow warbler red yellow body yellow crown yellow head yellow breast query ground truth class predicted class rationale ground truth rationale predicted figure frequent noun phrases utilized learning embed group semantically similar words keypoint based annotations assign different weights attributes according spatial distribution feature map potential tions include explaining adversarial examples based zero shot learning references antol s agrawal lu j mitchell m batra d lawrence zitnick c parikh d vqa visual question answering ieee international conference computer vision iccv bau d zhou b khosla oliva torralba network dissection quantifying interpretability deep visual representations computer vision pattern recognition deng j dong w socher r li l li k imagenet large scale hierarchical fei l age database computer vision pattern recognition cvpr ieee conference ieee erhan d bengio y courville vincent p visualizing higher layer features deep network nical report university montreal farhadi hejrati m sadeghi m young p rashtchian c hockenmaier j forsyth david e k maragos p paragios n picture tells computer story generating sentences images vision eccv berlin heidelberg springer berlin heidelberg goodfellow j shlens j szegedy c ing harnessing adversarial examples arxiv e prints google inceptionism going deeper neural works googleblog inceptionism going deeper neural html k zhang x ren s sun j deep residual learning image recognition cvpr k gkioxari g dollar p girshick r mask r cnn ieee international conference puter vision iccv hendricks l akata z rohrbach m donahue j schiele b darrell t generating visual european conference computer vision planations springer huang g liu z van der maaten l weinberger k q densely connected convolutional networks ieee conference computer vision pattern recognition cvpr krizhevsky sutskever hinton g e agenet classication deep convolutional neural works nips lin t roychowdhury maji s ear cnn models fine grained visual recognition iccv mahendran vedaldi understanding deep image representations inverting ieee conference computer vision pattern recognition cvpr mikolov t chen k corrado g dean j cient estimation word representations vector space arxiv preprint nguyen dosovitskiy yosinski j brox t clune j synthesizing preferred inputs rons neural networks deep generator networks vances neural information processing systems nguyen clune j bengio y dosovitskiy yosinski j plug play generative networks tional iterative generation images latent space ieee conference computer vision pattern tion cvpr nguyen yosinski j clune j deep neural networks easily fooled high condence predictions unrecognizable images ieee conference puter vision pattern recognition cvpr reed s akata z yan x logeswaran l schiele b lee h generative adversarial text image thesis arxiv preprint rohrbach rohrbach m hu r darrell t schiele b grounding textual phrases images reconstruction arxiv e prints black crownshort beakwhite breastpointy beakblack beakblack headwhite throatblack billbrown crownsmall beakyellow breastwhite bodyblack eyesmall billlong billlong tailpointed billred crownlong neckyellow billshort billsmall headshort pointy billwhite headyellow beakblack eyeringblack throatwhite crownlong beakyellow crowngrey crowngrey headblue crownbrown headyellow bodyblue headblack bodyyellow throatblack cheek patchwhite chestpointed beakblack taillong black billbrown beakgray crownblack wingred headwhite eyebrowyellow headsharp beakbrown breastblack breastwhite eyeringsmall black billwhite neckbrown bodyblack tarsuslight browndark brownred breastlong black beakcheek patchwhite wingblack backthick billsharp billsmall black beaklarge beakgray headwhite napeshort black billdark greywhite eyelarge headwhite beakshort pointed billbrown eyered eyeblack napegreen crownred beakgreen headsmall brownshort black beakwhite billlarge billbright orangesharp black beakgray bodyyellow chestbright yellowred throatwhite stripeblack faceblack stripeshort tailwhite eye ringgray beakflat billgrey selvaraju r r cogswell m das vedantam r parikh d batra d grad cam visual nations deep networks gradient based localization ieee international conference computer vision iccv sermanet p frome real e attention fine grained categorization iclr simonyan k zisserman deep volutional networks large scale image recognition iclr simonyan k vedaldi zisserman deep inside convolutional networks visualising image cation models saliency maps arxiv e prints springenberg j t dosovitskiy brox t miller m striving simplicity lutional net arxiv e prints szegedy c zaremba w sutskever bruna j erhan d goodfellow fergus r intriguing ties neural networks arxiv e prints van horn g branson s farrell r haber s barry j ipeirotis p perona p belongie s building bird recognition app large scale dataset citizen scientists ne print ne grained dataset collection proceedings ieee conference computer vision pattern recognition wah c branson s welinder p perona p belongie s caltech ucsd dataset technical report cns yosinski j clune j nguyen fuchs t lipson h understanding neural networks deep visualization arxiv e prints zeiler m d fergus r visualizing standing convolutional networks eccv zhang n donahue j girshick r darrell t based r cnns fine grained category detection eccv zhang q cao r shi f nian wu y zhu s interpreting cnn knowledge explanatory graph aaai zhou b khosla lapedriza oliva torralba object detectors emerge deep scene cnns iclr zhou b khosla lapedriza oliva torralba learning deep features discriminative ization ieee conference computer vision pattern recognition cvpr
