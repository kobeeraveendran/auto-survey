n u j a f h t a m v v i x r a a few calculus rules for chain dierentials d e clark j houssineau e d delande abstract this paper summarizes the core denitions and results regarding the chain dierential for functions in locally convex topological vector spaces in addition it provides a few elementary calculus rules of practical interest notably for the dierentiation of characteristic functionals in various domains of physical science and engineering functional dierentiation in this section we discuss two dierent forms of dierential the gateaux dierential and the chain dierential the chain dierential which is similar to the epiderivative is adopted since it is possible to determine a chain rule yet is not as restrictive as the frechet derivative results are stated for locally convex topological vector spaces which include banach spaces such as hilbert and euclidean spaces rn as well as spaces of test functions for the study of distributions this type of space is therefore suciently general for most practical applications gateaux dierential denition gateaux dierential let x and y be locally convex topological vector spaces and let be an open subset of x and let y the gateaux dierential at in the direction x is f lim when the limit exists if f exists for all x then is gateaux dierentiable at the gateaux dierential is homogeneous of degree one in so that for all real numbers f in denition the space x might be a function space in this case functions on x can be referred to as functionals chain dierential due to the lack of continuity properties of the gateaux dierential further constraints are required in order to derive a chain rule bernhard proposed a new form of gateaux dierential dened with sequences which he called the chain dierential it is not as restrictive as the frechet derivative though it is still possible to nd a chain rule that maintains the general structure denition chain dierential the function x y where x and y are locally convex topological vector spaces has a chain dierential f at point x in the direction x if for any sequence m x and any sequence of real numbers m it holds that the following limit exists f lim m m mm if x xn where are locally convex topological vector spaces xn x and n x the chain dierential f if it exists is also called the total chain dierential of at point in the direction denition nth order chain dierential the nth order chain dierential of at point in the sequence of directions is dened recursively with nf y y n for the sake of simplicity when there is no ambiguity on the point at which the chain dierential is evaluated the chain dierential f may also be written as the nth order chain dierential then takes the more compact form nf n similarly to the notion of partial derivatives the notion of chain dierential can be dened for appropriate multivariate functions denition partial chain dierential let and y be locally convex topological vector spaces the function xn y has a partial chain dierential if with respect to the ith variable at point xn xn in the direction xi if for any sequence m xi and any sequence of real numbers m it holds that the following limit exists if lim m xi mm xn m core calculus rules for the chain dierential this section summarises the core derivation rules for the chain dierential note that they all have a counterpart dened for the usual derivative lemma chain rule from theorem let x y and z be locally convex topological vector spaces y z g x y and g and have chain dierentials at in the direction and at in the direction respectively then the composition f g has a chain dierential at point in the direction given by the chain rule f note that unlike its counterpart for the usual derivative the chain dierential of a composition g does not reduce to the product of a chain dierential of f and a chain dierential of g this key ference has important implications on the structure of the general higher order chain rule in theorem similarly to the usual derivatives the total chain dierential of a multivariate function see nition can be constructed in certain conditions dened in the theorem below as a sum involving its partial chain dierentials see denition theorem total chain dierential from theorem let and y be locally convex topological vector spaces xn y xn and n xn if for i n it holds that the partial chain dierential if exists in a neighbourhood xn of x and the function if xn is continuous over xi then has a total chain dierential at point in the direction and it is given by f if i n x the proof is given in appendix in section a this intermediary result is an important component in the construction of the general higher order chain rule in theorem theorem general higher order chain rule from theorem let x y and z be locally convex topological vector spaces and y z assume that g x y has higher order chain dierentials at point in all the sequences of directions i n assume additionally that there exists an open subset y such that and i n if for every point y and every sequence m m n it holds that has a mth order chain dierential at point y in the sequence of directions and the conditions of theorem hold for the function y m mf the functions j mf j m are linear and continuous on then the nth order chain dierential of the composition g at point in the sequence of directions is given by n x where n n denotes the set of the partitions of the index set n and denotes the cardinality of the set the proof is given in appendix in section a the counterpart for usual derivatives is known as di bruno s rule theorem general higher order product rule let x and y be locally convex topological vector spaces and let g x y and x y assuming that and g have higher order chain dierentials at point in all the sequences of directions i n then the product g has a nth order chain dierential at point in the sequence of directions and it is given by where c n denotes the complement of in n n the proof is given in appendix in section a the counterpart for usual derivatives is known as leibniz rule practical derivations for the chain rule this section provides specic applications of the chain rule given in lemma in which the outer function of the composition g assumes a specic form commonly encountered in practical derivations theorem practical derivations for the chain rule let x y and z be locally convex topological vector spaces y z g x y assume additionally that g has a chain dierential at some point in some direction then if is a continuous linear function then the composition g has a chain dierential at point in the direction and it is given by leibniz rule if is the kth power function y yk k then the composition g has a chain dierential at point in the direction and it is given by y yk g k if is the exponential function exp then the composition g has a chain dierential at point in the direction and it is given by exp the proof is given in appendix in section a appendix a proofs a total chain dierential theorem proof the result is proved in the case n from which the general case can be straightforwardly deduced let us x a point y and a direction such that has partial chain dierentials and let us then x arbitrary sequences of directions m m and an arbitrary sequence of real numbers m for m we can write m m m m mm y mm y mm m mm where we dene and as follows given m dene h r r as tm from the mean value theorem for real valued functions there exists cy m such that mm y m dh t cy which when replacing by tm can be rewritten m mm cym cym m where lemma has been used to obtain the last equality similarly for there exists cx m such that mm cxm m let us now prove that the limit of the term is equal to when r substituting and into becomes m m m cxm m cym m by the triangle inequality is bounded above by the following summation cxm m m cym substituting and with f the bound becomes cxm y m m y cym which tends to when m because of the continuity of the functions y and thus it holds that that is has a total chain dierential in point in direction and it is such that lim m m m m f which is equivalent to the proposition in a general higher order chain rule theorem proof the proof is constructed by induction on the number of directions n lemma gives the base case n for the induction step we apply the dierential operator to the case n to give the case n and show that it involves a summation over partitions of elements in the following way u the main objective in this proof is to calculate a term of the summation on the right hand side of n x of the form u kf the additional dierentiation with respect to applies to every function on x i e to the function g and to the functions hi i to highlight the structure of this result we can dene a multi variate function f such that y z f yk kf so that can be rewritten as f u which is equal to f u in let us using lemma let us focus on the direction dene a sequence m x and a sequence of real numbers m using the denition of the chain dierential we can write u u m lim m mm mm mm where the last equality is given by the denition of the chain dierential applied to the functions g and hi i substituting into and applying theorem becomes consider the rst term of the summation in k x using the denition of f it can be written as is equal to y kf which by denition of the k order chain dierential now consider any other term in using the denition of f it can be written as y kf y let us dene a sequence m y and a sequence of real numbers m using the denition of the chain dierential becomes mm kf kf m lim m lim m h kf m kf while the rst equality exploits the linearity of the function y kf and the second equality its continuity on y substituting and in becomes kf x considering and ji and replacing the result into we nd j n x x n x x j j following a similar argument used for the recursion of stirling numbers of the second kind and their relation to bell numbers the result above can be viewed as a means of generating all partitions of n elements from all partitions of n elements the rst term in eq corresponds to the creation of a new element to the partition n containing only n and each term in the second summation appends n to one of the existing element of the partition this argument follows similar arguments previously used for ordinary and partial derivatives hence the result is proved by induction a general higher order product rule theorem proof the proof is constructed by induction on the number of directions n case n we can write immediately case n let us x a point x and a direction x such that both and g have a rst order chain dierential at point in direction let us then x a sequence x and a sequence of real numbers m since f has a rst order chain dierential at point it is continuous in and thus lim m since both and g have a rst order chain dierential at point in direction we have lim m lim m m m from and it holds that m lim m lim m m lim m lim m m f lim m m that is g has a rst order chain dierential at point in direction and it is such that f case n x n such that both and g have higher let us x a point x and a sequence of directions order chain dierentials at point in all sequences of directions i n we can then write n n n n n n where the last equality was obtained by exploiting case n thus g has a nth order chain dierential at point in directions n and it is such that this ends the proof by induction n a practical derivations for the chain rule theorem proof let us x a point x and a direction x such that g has a chain dierential at point in direction let us then x a sequence m y and a sequence of real numbers m a let us assume that is a continuous linear function for any m we can write m mm m thus it holds that mm lim m m lim m m lim m thus using the denition of the chain dierential we have using the chain rule ends the proof let us assume that is the kth power function y yk for some for any m we can write m mm k k m i p h x p i p p x p x m p i thus it holds that lim m m mm lim m m p x i p k z lim m lim m z z thus using the denition of the chain dierential we have yk using the chain rule ends the proof let us assume that is the exponential function for any m we can write m exp mm exp m exp h m exp mm thus it holds that lim m m exp mm exp exp lim m m lim m m h exp z z thus using the denition of the chain dierential we have using the chain rule ends the proof exp exp references analysis j aubin and h frankowska set valued analysis birkhauser p bernhard chain dierentials with an application to the mathematical fear operator nonlinear d e clark and j houssineau bruno s formula for chain dierentials f bruno note sur un nouvelle formule calcul quarterly journal of pure and applied mathematics r gateaux fonctions dune innite variables independantes bulletin de la societe mathematique france m hardy combinatorics of partial derivatives electronic journal of combinatorics h huang s a m marcantognini and n j young chain rules for higher derivatives the mathematical intelligencer t w ma higher chain formula proved by combinatorics electronic journal of combinatorics r stanley enumerative combinatorics volume cambridge university press edition
