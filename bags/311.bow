proceedings cern accelerator school course numerical methods analysis design modelling particle accelerators thessaloniki greece linear optics computations sterbini abstract chapter briey recall summarize main linear optics concepts accelerators beam dynamics theory emphasis related computational aspects reader provided basic elements write linear optics code aim complement text practical examples code listings introduction linear optics theory developed years ago rst success demonstrate overall focusing effect sequence alternating focusing defocusing rupoles called alternating gradient principle despite based simple linear algebraic concepts alternating gradient principle history accelerators linear optics design accelerator rst step understanding particle motion foundation study non linear haviour lattice importance acquire solid knowledge familiarity concepts associated numerical methods presently main challenges accelerator beam dynamics resides description long term behaviour non linear tem chapter intended introduction problems phenomena presented following chapters rich bibliography covering subject indicated short partial list references reader assumed familiar basic concept linear optics goal linear optics general beam dynamics describe motion particles traveling accelerator linear attribute refers assumptions approximation variation particle coordinates depends linearly coordinates introduce linear optics theory equivalent directions followed integrating equations motion historical approach presents limits trying generalize non linear systems hamiltonian formalism describe particle motion approach ural generalize solutions non linear dynamics problems available online web cern previous schools computational approach deriving linear optics theory linear algebra cepts approach standard linear optics codes follow chapter reference system presented previous paragraph aim beam dynamics describe particle motion accelerator need associate particle set coordinates respect specic reference system describe evolution time number coordinates depend degrees freedom considering reference systems principle chosen laboratory reference system describe phase space particle spatial coordinates particle momentum components reference system convenient describe efcient way particle motion fact simplify formalism expressing motion relative given particle reference particle words choose reference system moving reference particle coordinates intended variations respect reference particle reference particle denes reference orbit circular machine orbit align machine elements orbit dening geometry machine single passage machines like linac reference trajectory dipolar contributions present machine contributing dening circular machine geometry dene beam closed orbit fig convenient replace independent variable time longitudinal position reference orbit trajectory conditions module particle momentum phase space replaced trace space explicitly stated implicitly refer phase space trace space fact phase space differently trace space features conservation property present following sections central linear optics computations linear transformations optics system linear evolution coordinates particle trajectory closed orbit reference orbit figure reference systems gure reference systems shown laboratory ence system blue moving reference system black worth noting depends longitudinal abscissa reference orbit black line reference orbit described denition xed point respect frame closed orbit red later single turn oscillation orange later described respect frame expressed square matrix depend important note interested special set linear transformations called symplectic linear transformations ones associated symplectic matrix following present concept symplectic matrix physical meaning need introduce concept linear product linear product linear product vectors associated square matrix dened scalar example dot product linear product equal identity matrix following interesting study properties linear transformations preserves linear product associated observing conclude preserves linear product associated noted preserving linear product associated preserve associate linear product group linear transformations following present examples group orthogonal symplectic matrices example orthogonal matrix let consider simplicity case assuming linear transformation dot product vaua vbub matrix preserves linear transformation projections called orthogonal matrix physical meaning orthogonal matrix lies fact preserves projection vectors rotation expressed orthogonal matrix example symplectic matrix assuming vaub vbua linear transformation proportional amplitude cross product proportional area dened vectors matrix preserves linear formation related cross product called symplectic matrix physical meaning symplectic matrix lies fact preserves area vectors fig graphical representation orthogonal symplectic linear formation comparing generic vectors identity transformation upper plot orthogonal transformation middle plot note dot product conserved symplectic transformation lower plot given set vectors dening polygon face polygon preserved reason symplectic linear transformation preserves phase space areas concept lies general theorem classical mechanics phase space liouville theorem concepts introduced far generalized particular matrix example symplectic matrix block symplectic following worth recalling important properties symplectic group mentioned symplectic symplectic identity transformation coordinate arb units orthogonal transformation coordinate arb units symplectic transformation coordinate arb units figure examples identity orthogonal symplectic transformations symplectic symplectic symplectic matrix invertible symplectic inversion symplectic matrix efcient term computational cost necessary sufcient condition symplectic case condition necessary sufcient example symplectic matrix following symplectic matrices defective diagonalized symplectic matrix accelerators concept symplectic transformation dene basic building blocks stitute linear transformation accelerator particular consider following matrices drift thin quad thin telescope matrices recognise long drift thin quadrupole focal length addition thin telescope matrix matrix reduces identical transformation introduces discontinuity position coordinate thin matrix thin quadrupole introduces discontinuity momentum coordinate thin kick conveniently combining drifts thin quadrupole known matrices thick elements example thick quadrupole derive transfer matrix thick quadrupole length normalized gradient decomposing identical optics cells cell constituted drift thin quadrupole focal length quadrupole matrix solving following limit decomposition obtain thick lens lim cos sin sin cos compute limit general symbolic computations prot available symbolic computation tools mathematica python package sympy example symbolic calculation limit given listing established correspondence elements machine drift bending rupoles solenoids symplectic matrices rich list matrix transformations accelerator refer appendix tracking linear system given sequence elements lattice evolution coordinate lattice given particle obtained transport particles lattice called tracking tracking linear tem trivial following unnecessary fact decompose trajectory single particle term invariant motion properties lattice properties describe trajectory single particle statistical evolution ensemble particles beam instead tracking ensemble particles concentrate dene compute properties lattice hand beam hand linear lattices periodic lattice stability study motion particles periodic lattice lattice constituted denite repetition basic long period represent mot called turn map linear matrix single turn periodicity mot mot subscript refer turn number following study property mot stable motion lattice words verify lattice stable need verify elements matrix stay bounded solve problem use following equivalent factorization forms diagonal factorization factorization twiss factorization diagonal factorization mot expressed diagonal factorization diagonal form mot turns dmp stability depends eigenvalues mot note eigenvector eigenvector uniquely dened chose physical meaning tion appear clearly later convenient compatible standard denitions accelerator dynamics worth recalling following properties real matrix eigenvalues complex appear complex conjugate pairs symplectic matrix mot eigenvalues mot symplectic matrix eigenvalues written eiot eiot loss generality consider implies power matrix reduced simple scalar multiplication real motion stable dene fractional tune periodic describe section compute total phase advance lattice machine integer tune factorization diagonal factorization introduced convenient check stability visualize turn turn phase space evolution particle worth considering factorization mot cos sin sin cos orthogonal mot diagonalized expressed factorization fact diagonal factorization factorization note cos sin sin cos eiot introduced matrix easily express function observing mot note choosing det got det expressed product orthogonal symplectic matrices result relevant implies mot similar pure rotationv convenient change base expressed matrix physical phase space normalized phase space periodic motion clockwise rotation angle twiss factorization mot note cos sin yielding called twiss factorization mot cos sin worth observing properties expressions proved symbolic computation listing following parametric expression proposed dening twiss parameters lattice start sequence mot important depending turn number words twiss parameters stable periodic lattice periodic ition express function twiss parameters figure similarity turn map matrices referred different points summarise matrix mot diagonalizable lattice stable eigenvector matrix conveniently normalized fractional tune det twiss parameters lattice mot starting point listing example computing optical functions mot starting point shown twiss parameters machine given long periodic lattice longitudinal positions depicted fig transformation expressed transport matrix implies mot mot mot mot matrices mot mot similar genvalues observation yields mot dependent tune transport observe dependent functions fact mot mot cos sin inverse symplectic matrix equation allows propagate initial condition optical functions lattice worth noting remembering denition matrix transform physical phase space normalized phase space normalized phase space respectively example function drift compute twiss parameters drift starting simply apply previous equation yielding differential relation discussed compute start lattice propagate lattice like investigate differential relation functions position consider general matrix innitesimal quadrupole length note product drift length thin focusing quadrupole gradient neglected second order terms symplectic observing lim standard notation replacing differentialj obtains replacing equation functions yields non linear differential equation important note discussing linear optics differential equation strongly non linear order avoid linear tracking decompose problem properties lattice properties beam introduced new functions positions related non linear differential equation lattice gradients example matrices hill equation following notation introduced hill equation lim starting pure matrix approach mentioned lorentz force shows equivalence formalisms courant snyder invariant showed compute optics functions lattice functions ent particle initial conditions section going investigate given particle initial coordinate dene dependent quantity conserved ing motion particle machine invariant exists called courant snyder invariant action particle dened jcs fact jcs jcs noted invariant motion dened jcs normalized phase space remembering jcs half square radius dened particle initial position normalized phase space angle particle dened particle initial angle normalized phase space polar coordinates normalized phase space called action angle space listing going matrix form polynomial form nds denition invariant jcs function optics functions worth noting assumptions trace space phase space equivalence section invariant motion expressed trace space variables jcs xpx tracespace noted equivalent dimensional point view despite sake simplicity consistency existing conventions use symbol jcs invariants betatron phase normalized space observed transport change jcs angle varies introduced linear matrix compute consider normalized phase space yields cos sin sin cos previous equation gets tan sin cos depend phase advance end transformation integer tune circular machine length dened represents number betatronic oscillations worth noting following relation holds represents integer number betatronic periods machine example differential equation previous equation gets lim tan lim known expression trace space trace space trace space trace space figure betatron oscillations physical normalized trace spaces referred respectively example assumed tune phase advance noted transformations trace spaces symplectic positions represented gure jcs number markers indicates turn number example betatron oscillations describe betatron oscillation terms twiss parameters particle initial conditions easily transforming vector normalized phase space moving normalized space pure rotation phase transform original phase space shown fig important result implies motion particle pure rotation normalized phase space machine generalizes result obtained factorization mot listing express matrix function optics function yielding cos sin cos sin sin cos sin example solution hill equation remembering important result motion particle pure rotation normalized phase space machine express motion particle initial condition normalized phase space action initial phase jcs denition jcs follows radial position particle normalized phase space angular position phase addition initial phase remembering positive rotation clockwise gets jcs jcs jcs solution hill equation given particle initial conditions jcs example matrix formula implicitly assumed closed orbit corresponded reference orbit true fact machine operation switch dipole correctors additional ones dening alignement magnetic elements assuming mot single thin kick independent write mot case represent kick dipole correction misalignment quadrupole closed orbit solution retrieved imposing xed point turn yielding mot xed point note discontinuous previous formula refers kick solving transporting xed point shown listing found known equation closed orbit phase advance relax condition replacing presence multiple sum single contributions computing dispersion chromaticity considered optics parameters momentum particle evaluate momentum effect closed orbit tune introduce dispersion chromaticity functions respectively order compute numerically compute cox function compute mot evaluating property element lattice function thin quadrupole focal length linearly scales particle momentum figure trace space ensemble particles dipolar corrector scales inverse beam rigidity dipolar magnet dening reference orbit arc dipole synchrotron important consider differential kick momentum particle ensembles beam distribution beam considered set particles fig track particles use approach single particle tracking matrix restrict case looking statistical quantities represents ensemble evolution lattice natural average jcs ensemble denition follows quantity preserved beam evolution linear lattice beam emittance converges specic assumptions later rms emittance beam jcs det xbx matrix preserved symplectic linear transformation xbx represents beam matrix cauchy binet theorem det xbx xbx denotes det det xbx det transport equation similar figure matched beam normalized phase space matrix matrix denition follows trace space xixi ixi rms rms write summarize transport equation matrix statistical meaning showed numerically transport second order moments beam distribution matched beam distribution beam distribution matched specic optics functions responding normalized distribution statistically invariant rotation words azimuthal symmetry example matched mismatched beams presented fig respectively worth noting figure mismatched beam normalized phase space symplectic matrix matched beam rms rms conclude normalized matrix diagonal beam distribution matched specic optics functions found rms beam size divergence formulas ively eqs conclude beam matched position matched implies second order statistical moments matched beam periodic stable lattice given position turn turn invariant concluding chapter demonstrate matched beam straightforward normalized phase space fact beam matched yielding jcs conclusion chapter recalled summarized main linear optics concepts accelerators beam dynamics theory emphasis related computational aspects pure linear algebra approach symplectic matrices transformations introduced concepts lattice stability optics functions normalized phase space invariant motions addition dynamics single particle studied ensembles particles presenting statistical invariant ensemble concept beam matching appendix code listings convenience reader electronic version mathematica listings found respectively input mathematica fullsimplify limit matrixpower infinity assumptions output cos sqrt sin sqrt sqrt sqrt sin sqrt cos sqrt listing mathematica input compute thick quadrupole matrix limit thin quadrupoles drifts input sympy import import numpy symbol symbol symbol symbol omega matrix pbar matrix pbar omega pbar inv simplify subs output matrix listing symbolic expression matrix input import numpy linalg drift def drift return array matrix long drift quadrupole def quad matrix quadrupole focal lenght return array turn maps long fodo cell focal length def drift return eigenvalues eig det len normalization diag eigenvalues compute beta alpha beta real alpha real sqrt beta print cell phase advance angle normalization deg print periodic beta start cell str beta print periodic alpha start cell str alpha output cell phase advance deg periodic beta start cell periodic alpha start cell listing basic linear optics code input sympy import alpha symbol alpha beta symbol beta gamma symbol gamma symbol symbol omega matrix matrix alpha beta gamma alpha matrix expand inv subs alpha beta gamma output alpha beta gamma listing matrix polynominal form jcs input import sympy symbol symbol symbol symbol symbol symbol symbol matrix sqrt sqrt sqrt matrix sqrt sqrt sqrt symbol matrix pprint simplify inv output matrix sqrt sqrt sqrt sqrt sqrt sqrt sqrt sqrt listing phase advance computation input import sympy symbol symbol symbol symbol phi symbol phi symbol symbol matrix sqrt sqrt sqrt matrix sqrt sqrt sqrt matrix cos phi sin phi sin phi cos phi simplify inv output matrix sqrt sin phi cos phi sqrt sqrt sqrt sin phi sin phi cos phi cos phi sin phi sqrt sqrt sqrt sin phi cos phi sqrt listing transport matrix function optics parameter input import sympy symbol symbol symbol symbol symbol symbol phi symbol phi matrix matrix mco simplify cos sin inv simplify matrix matrix sqrt cos phi sin phi sqrt sqrt sqrt sin phi cos phi sin phi sin phi sqrt sqrt sqrt cos phi sin phi sqrt simplify output matrix sqrt sqrt sin phi cos phi tan sqrt sin phi cos phi tan sin phi tan cos phi sqrt listing closed orbit computation bibliography courant snyder annals physics herr non linear beam dynamics proceedings forest truncated power series algebra proceedings papaphilippou analysis techniques proceedings rossbach schmser basic course accelerator optics vol lee accelerator physics world scientic singapore peggs satogata introductions accelerator dynamics cambridge university wolski beam dynamics high energy accelerators imperial college press london press cambridge chao mess tigner zimmermann handbook accelerator physics engineering edition world scientic singapore adelmann linear algebra proceedings cern cern ipynb
