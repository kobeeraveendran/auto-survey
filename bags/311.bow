proceedings cern accelerator school course numerical methods analysis design modelling particle accelerators thessaloniki greece linear optics computations g sterbini abstract chapter briey recall summarize main linear optics concepts accelerators beam dynamics theory emphasis related computational aspects reader provided basic elements write linear optics code aim complement text practical examples code listings introduction linear optics theory developed years ago rst success demonstrate overall focusing effect sequence alternating focusing defocusing rupoles called alternating gradient principle despite based simple linear algebraic concepts alternating gradient principle history accelerators linear optics design accelerator rst step understanding particle motion foundation study non linear haviour lattice importance acquire solid knowledge familiarity concepts associated numerical methods presently main challenges accelerator beam dynamics resides e description long term behaviour non linear tem chapter intended introduction problems phenomena presented following chapters rich bibliography covering subject indicated short partial list references reader assumed familiar basic concept linear optics goal linear optics general beam dynamics describe motion particles traveling accelerator linear attribute refers assumptions approximation variation particle coordinates depends linearly coordinates introduce linear optics theory equivalent directions followed integrating equations motion historical approach presents limits trying generalize non linear systems hamiltonian formalism describe particle motion approach ural generalize solutions non linear dynamics problems available online web cern ch previous schools n u j h c c s c s y h p v v x r computational approach deriving linear optics theory linear algebra cepts approach standard linear optics codes follow chapter reference system presented previous paragraph aim beam dynamics describe particle motion accelerator need associate particle set coordinates respect specic reference system describe evolution time number coordinates depend degrees freedom considering reference systems principle chosen e laboratory reference system describe phase space x px y py z pz particle x y z spatial coordinates particle px py pz momentum components reference system convenient describe efcient way particle motion fact simplify formalism expressing motion relative given particle reference particle words choose reference system co moving reference particle coordinates y py z pz intended variations respect reference particle reference particle denes reference orbit circular machine orbit align machine elements e orbit dening geometry machine single passage machines like linac reference trajectory dipolar contributions present machine contributing dening circular machine geometry dene beam closed orbit fig convenient replace independent variable time t longitudinal position s reference orbit trajectory conditions pz module particle momentum phase space replaced trace space y dy ds dz ds dx ds explicitly stated implicitly refer phase space trace space fact phase space differently trace space features conservation property present following sections central linear optics computations linear transformations optics system linear evolution coordinates particle trajectory closed orbit reference orbit y z x figure reference systems gure reference systems shown laboratory ence system x y z blue co moving reference system black worth noting depends s longitudinal abscissa reference orbit black line reference orbit described denition xed point respect frame closed orbit red later single turn oscillation orange later described respect frame expressed m m square matrix depend important note interested special set linear transformations called symplectic linear transformations ones associated symplectic matrix following present concept symplectic matrix physical meaning need introduce concept bi linear product bi linear product bi linear product vectors v u associated square matrix f dened scalar v t f u example dot product bi linear product f equal identity matrix following interesting study properties linear transformations m preserves bi linear product associated f observing v t f u m v t f m u f m t f m conclude m preserves bi linear product associated f f m t f m noted m n preserving bi linear product associated f m n n m preserve associate bi linear product group linear transformations following present examples group orthogonal symplectic matrices example orthogonal matrix let consider simplicity case u v va assuming bi linear transformation dot product v va u f v t f u vaua vbub matrix m preserves bi linear transformation projections m u v t u m t m v t m t m v t m called orthogonal matrix physical meaning orthogonal matrix lies fact preserves projection vectors e rotation expressed orthogonal matrix example symplectic matrix assuming f v t f u vaub vbua bi linear transformation proportional amplitude cross product v va u proportional area dened vectors matrix m preserves bi linear formation related cross product v t m t m u v t u m t m m called symplectic matrix physical meaning symplectic matrix lies fact preserves area vectors fig graphical representation orthogonal symplectic linear formation comparing generic vectors identity transformation upper plot orthogonal transformation middle plot note dot product conserved symplectic transformation lower plot given set n vectors dening polygon face polygon preserved reason symplectic linear transformation preserves phase space areas concept lies general theorem classical mechanics phase space liouville theorem concepts introduced far generalized nd particular matrix example symplectic matrix block symplectic following worth recalling important properties symplectic group mentioned symplectic m symplectic identity transformation coordinate arb units orthogonal transformation coordinate arb units s t n u b r t n r o o c b s t n u b r e t n r o o c b s t n u b r t n r o o c b symplectic transformation coordinate arb units figure examples identity orthogonal symplectic transformations m symplectic m t symplectic symplectic matrix invertible m m t m symplectic inversion symplectic matrix efcient term computational cost necessary sufcient condition m symplectic case condition necessary sufcient example symplectic matrix m following symplectic matrices defective diagonalized e symplectic matrix accelerators concept symplectic transformation dene basic building blocks stitute linear transformation accelerator particular consider following matrices g l g drift thin quad thin telescope matrices recognise l long drift thin quadrupole focal length addition thin telescope matrix matrix reduces identical transformation g g introduces discontinuity position coordinate thin matrix thin quadrupole introduces discontinuity momentum coordinate thin kick conveniently combining drifts thin quadrupole nd known matrices thick elements example thick quadrupole derive transfer matrix thick quadrupole length l normalized gradient decomposing n identical optics cells cell constituted drift l n thin quadrupole focal length quadrupole matrix solving following limit n l decomposition obtain thick lens lim n l n cos l n n sin sin cos compute limit general symbolic computations prot available symbolic computation tools e mathematica python package sympy example symbolic calculation limit given listing established correspondence elements machine drift bending rupoles solenoids symplectic matrices rich list matrix transformations accelerator refer appendix tracking linear system given sequence elements mk lattice evolution coordinate xn lattice given particle obtained xn mn n transport particles lattice called tracking tracking linear tem trivial following unnecessary fact decompose trajectory single particle term invariant motion properties lattice properties describe trajectory single particle statistical evolution ensemble particles beam instead tracking ensemble particles concentrate dene compute properties lattice hand beam hand linear lattices periodic lattice stability study motion particles periodic lattice lattice constituted denite repetition basic c long period represent mot m called turn map linear matrix single turn periodicity mot m mot m c eq xm m m ot m subscript m refer turn number following study property mot m stable motion lattice x m words verify lattice stable need verify elements matrix ot m stay bounded m solve problem use following equivalent m m factorization forms diagonal factorization r factorization twiss factorization diagonal factorization mot m expressed diagonal factorization e diagonal form mot m p d p m turns m m ot m p dp p dp p dp p dmp stability depends eigenvalues mot m note v eigenvector kv eigenvector p uniquely dened chose p physical meaning tion appear clearly later convenient compatible standard denitions accelerator dynamics worth recalling following properties real matrix eigenvalues complex appear complex conjugate pairs symplectic matrix mot m eigenvalues mot m symplectic matrix eigenvalues written eiot m eiot m loss generality consider ot m implies dm m power matrix reduced simple scalar multiplication real motion stable dene fractional tune periodic describe section compute total phase advance ot m lattice machine integer tune r factorization diagonal factorization introduced convenient check stability visualize turn turn phase space evolution particle worth considering factorization mot m p cos ot m sin ot m sin ot m cos ot m m orthogonal p mot m diagonalized expressed r factorization fact diagonal factorization r factorization note cos ot m sin ot m sin ot m cos ot m m m eiot m m s introduced matrix s easily express p function p s observing rm m mot m p s d s r p p e p p s note choosing det p got det p expressed m product orthogonal symplectic matrices result relevant implies mot m similar pure rotationv convenient change base expressed matrix p physical phase space normalized phase space periodic motion clockwise rotation angle ot m twiss factorization mot m note m cos ot m sin ot m yielding called twiss factorization mot m p p cos ot m p p j sin ot m worth observing j properties expressions proved symbolic computation listing following parametric expression j proposed dening twiss parameters lattice start sequence mot m important depending turn number m m m ot m m j m words twiss parameters stable periodic lattice periodic ition j j p p express p p p function twiss parameters p j p c c c figure similarity turn map matrices referred different points p p summarise matrix mot m diagonalizable lattice stable eigenvector matrix p conveniently normalized fractional tune det p eq nd twiss parameters lattice mot m starting point listing example computing optical functions mot m starting point shown twiss parameters machine given c long periodic lattice longitudinal positions depicted fig transformation c expressed m transport matrix implies mot m m m mot m mot m m mot m m matrices mot m mot m similar genvalues observation yields mot m s dependent tune transport observe s dependent functions fact mot m m mot m m m cos ot m sin ot m m m m eq inverse symplectic matrix m m t m m t equation allows propagate initial condition optical functions lattice worth noting eq remembering denition p matrix transform physical phase space normalized phase space p p normalized phase space respectively example function drift compute twiss parameters drift starting simply apply previous equation s s yielding differential relation discussed compute start lattice propagate lattice like investigate differential relation functions s position consider general m matrix innitesimal quadrupole length s m s note m product drift length s thin focusing quadrupole gradient neglected second order terms s m symplectic s eq s s m m t s s observing lim s s standard notation replacing eq eq differentialj obtains df ds replacing equation functions yields non linear differential equation important note discussing linear optics differential equation k strongly non linear order avoid linear tracking decompose problem properties lattice properties beam introduced new functions s positions related non linear differential equation lattice gradients example matrices hill s equation following notation introduced s m t x nd hill s equation lim s s starting pure matrix approach mentioned lorentz force shows equivalence formalisms courant snyder invariant showed compute optics functions lattice functions ent particle initial conditions section going investigate given particle initial coordinate x dene x dependent quantity conserved ing motion particle machine invariant exists called courant snyder invariant action particle dened jcs x t j x fact eq x t j jcs x t m t m m t m x t j jcs noted invariant motion dened jcs normalized phase space remembering x p x x t j x x t p t j p x x t x jcs half square radius dened particle initial position normalized phase space angle particle dened particle initial angle normalized phase space polar coordinates normalized phase space called action angle space listing going matrix form polynomial form nds denition invariant jcs function optics functions worth noting assumptions trace space phase space equivalence section invariant motion expressed trace space variables jcs xpx j tracespace cs noted eq equivalent dimensional point view eq despite sake simplicity consistency existing conventions use symbol jcs invariants betatron phase normalized space observed transport s s s change jcs angle varies s introduced linear matrix m compute consider normalized phase space p s p s s yields s m s p s m p cos sin sin cos previous equation gets tan sin cos depend s phase advance s s s end m transformation integer tune circular machine length c dened represents number betatronic oscillations s s c worth noting ot m e eq following relation holds ot m n represents integer number betatronic periods machine example differential equation previous equation m gets s lim tan s lim s known expression d s trace space trace space m m x mm x m m x mm x s p p s trace space trace space figure betatron oscillations physical normalized trace spaces referred x x respectively example assumed tune ot m phase advance noted transformations trace spaces symplectic positions represented gure jcs number markers indicates turn number example betatron oscillations describe betatron oscillation terms twiss parameters particle initial conditions easily transforming vector x normalized phase space moving normalized space pure rotation phase transform original phase space shown fig important result implies motion particle pure rotation normalized phase space machine generalizes result obtained r factorization mot m listing express m matrix function optics function yielding m p p cos sin cos sin sin cos sin example solution hill s equation remembering important result motion particle pure rotation normalized phase space machine express motion particle initial condition normalized phase space e action initial phase jcs denition jcs follows radial position particle normalized phase space angular position phase addition initial phase remembering positive rotation clockwise gets jcs jcs p jcs solution hill s equation given particle initial conditions jcs example co matrix co formula implicitly assumed closed orbit co corresponded reference orbit true fact machine operation switch dipole correctors additional ones dening alignement magnetic elements assuming mot m single thin kick independent xm write mot m case represent kick dipole correction misalignment quadrupole closed orbit solution retrieved imposing xm xed point turn yielding mot m eq nd xed point note co discontinuous previous formula refers co kick solving eq transporting xed point s eq shown listing found known equation closed orbit q phase advance s relax condition replacing presence multiple sum single contributions s computing dispersion chromaticity considered optics parameters momentum particle evaluate momentum effect closed orbit tune introduce dispersion dx chromaticity x y functions respectively p dx y s dx c p p qx y x y p p order compute numerically dx y x y compute cox y qx function compute mot m s evaluating property p element lattice function p thin quadrupole focal length linearly scales particle momentum p p p p figure trace space ensemble particles dipolar corrector scales inverse beam rigidity p p p p p dipolar magnet dening reference orbit e arc dipole synchrotron important consider differential kick momentum particle ensembles beam distribution beam considered set n particles fig track n particles use approach single particle tracking x xb n matrix xb xn restrict case n looking statistical quantities represents ensemble evolution lattice natural average jcs ensemble denition follows quantity preserved beam evolution linear lattice beam emittance converges specic assumptions later rms emittance beam n n jcs det n xbx t b matrix preserved symplectic linear transformation m xbx t b represents beam matrix n cauchy binet theorem det n xbx t b n xbx t b xb denotes m t det m det n xbx t b det m t m m t transport equation similar eq m m t m x x m figure matched beam normalized phase space matrix matrix denition eq follows e trace space n n n n xixi ixi n n n n rms rms write summarize transport equation matrix eq statistical meaning eq showed numerically transport second order moments beam distribution matched beam distribution beam distribution matched specic optics functions responding normalized distribution xb p statistically invariant rotation words xb azimuthal symmetry example matched mismatched beams presented fig respectively worth noting m x x m figure mismatched beam normalized phase space p symplectic matrix matched beam xb x t b p p n rms rms conclude normalized matrix diagonal beam distribution matched specic optics functions p p found rms beam size divergence formulas ively eqs conclude beam matched position matched s implies second order statistical moments matched beam periodic stable lattice given position s turn turn invariant concluding chapter demonstrate matched beam straightforward normalized phase space fact eq beam matched yielding jcs conclusion chapter recalled summarized main linear optics concepts accelerators beam dynamics theory emphasis related computational aspects pure linear algebra approach symplectic matrices transformations introduced concepts lattice stability optics functions normalized phase space invariant motions addition dynamics single particle studied ensembles particles presenting statistical invariant ensemble concept beam matching appendix code listings convenience reader electronic version mathematica listings found respectively input mathematica md l l mq kl kl fullsimplify limit matrixpower mq l n md l n n n infinity assumptions l output cos sqrt l sin sqrt l sqrt sqrt sin sqrt l cos sqrt l listing mathematica input compute thick quadrupole matrix limit thin quadrupoles drifts input sympy import import numpy np symbol symbol symbol symbol omega matrix pbar matrix j pbar omega pbar inv simplify j subs output matrix listing symbolic expression j matrix input import numpy np la np linalg drift def drift l return np array l matrix l long drift quadrupole def quad matrix quadrupole focal lenght return np array turn maps m long fodo cell m focal length def drift return eigenvalues p eig p p det p j len p p normalization d np diag eigenvalues compute beta alpha beta np real p alpha np real p np sqrt beta print cell phase advance np np angle d p normalization deg print periodic beta start cell str beta m print periodic alpha start cell str alpha output cell phase advance deg periodic beta start cell m periodic alpha start cell listing basic linear optics code input sympy import alpha symbol alpha beta symbol beta gamma symbol gamma symbol symbol px omega matrix j matrix alpha beta gamma alpha x matrix expand x inv subs alpha beta gamma output alpha beta gamma listing matrix polynominal form jcs input import sympy sy sy symbol sy symbol sy symbol sy symbol sy symbol sy symbol sy symbol sy sy matrix sy sqrt sy sqrt sy sqrt sy matrix sy sqrt sy sqrt sy sqrt symbol m sy matrix pprint sy simplify inv output matrix sqrt sqrt sqrt sqrt sqrt sqrt sqrt sqrt listing phase advance computation input import sympy sy sy symbol sy symbol sy symbol sy symbol phi sy symbol phi q sy symbol q sy symbol sy matrix sy sqrt sy sqrt sy sqrt sy matrix sy sqrt sy sqrt sy sqrt r sy matrix sy cos phi sy sin phi sy sin phi sy cos phi sy simplify inv output matrix sqrt sin phi cos phi sqrt sqrt sqrt sin phi sin phi cos phi cos phi sin phi sqrt sqrt sqrt sin phi cos phi sqrt listing transport matrix function optics parameter input import sympy sy sy symbol sy symbol sy symbol sy symbol q sy symbol q sy symbol phi sy symbol phi j sy matrix sy matrix mco sy simplify sy cos sy pi q j sy sin sy pi q inv sy simplify matrix t sy matrix sy sqrt sy cos phi sy sin phi sy sqrt sy sqrt sy sqrt sy sin phi sy cos phi sy sin phi sy sin phi sy sqrt sy sqrt sy sqrt sy cos phi sy sin phi sy sqrt sy simplify output matrix sqrt sqrt sin phi cos phi tan pi q sqrt sin phi cos phi tan pi q sin phi tan pi q cos phi sqrt listing closed orbit computation bibliography e courant h snyder annals physics w herr non linear beam dynamics proceedings e forest truncated power series algebra proceedings y papaphilippou analysis techniques proceedings j rossbach p schmser basic course accelerator optics vol s y lee accelerator physics world scientic singapore s peggs t satogata introductions accelerator dynamics cambridge university wolski beam dynamics high energy accelerators imperial college press london press cambridge w chao k h mess m tigner f zimmermann handbook accelerator physics engineering edition world scientic singapore adelmann linear algebra proceedings cern ch nb cern ch ipynb
