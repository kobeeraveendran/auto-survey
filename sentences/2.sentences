jet algorithms
wrapping up the subject f
v
tkachov institute for nuclear research of russian academy of sciences moscow russia
inr
ac
ru
inr
ac
this postscriptum to the theory of jet definition hep summarizes the points which did not find their way into the main text
c e d h e h v i x r a introduction i ve just been told that the subject of jet definition can never be wrapped up
what the title actually means is that this talk is supposed to close the series in which i was presenting the theory of jet definition as it evolved
the format and atmosphere of the qfthep workshops made them an ideal venue for that
in particular all my useful interactions with talists occurred or started at qftheps including the contact with physicists from which resulted in the dotting of an i in the observation of the top quark see sec

so first of all thanks to the or ganiz er theoretical synthesis of the optimal jet definition i do believe that the subject of jet definition is closed in the sense that every thing relevant and important has found its proper place in the theory of optimal jet definition ojd metaphysics what is measurement mathematical statistics the theory of quasi optimal observables whose relevance extends beyond jets to any parameter estimation problems where theoretical input is represented by a monte carlo event generator high mathematics the surprising relevance of the so called topologies for description of metric detectors and hadronic energy flow quantum field theory the central role of energy lators and their fundamental expression in terms of the energy momentum tensor qcd the issues of ir safety
numerical mathematics algorithms for minimum search in k dimensions and software engineering the use of advanced software development tools the person who said that announced after the talk his willingness to eat his words culminating in the design of a fast and robust optimal jet finder the code is available from
there is a remarkable synergy between different pieces and none can be omitted without damaging the whole
from the above list it should be clear why it took years to solve the problem of jet definition
principles of the theory the theory is systematically developed in two long papers
it is based on the following metaphysical realizations treated in detail in i an absolute importance of the subject
indeed data processing algorithms observables are a meeting point of experimental data and theoretical formulae hadronic jets are a way to observe quarks and gluons jets are everywhere in hep
realization of the absolute importance of the subject made me dismiss the that any reasonable piece of fortran code can in principle be accepted as a jet definition
the sentiment is only an expression of theoretical frustration at the years failure to find a solid foundation on which to build a systematic theory of jet definition
ii the theory of jet definition should be tightly linked to quantum field theory the theory of fundamental interactions of which jets are a visible manifestation
in fact my very first impression from the first explanations i received about jet algorithms from w
giele at fermilab in was a surprise at how un field theoretical the popular jet algorithms were
it was obvious to me as the discoverer of the algorithms on which the flourishing industry of nnlo qcd voiced by m
mangano at
there is a paradox here because g
sterman and s
weinberg each published a textbook on qft
i have an explanation for the paradox but it has nothing to do with the subject of jets
calculations is based that the conventional jet definitions do not conform to qft at the basic tical structural level resulting in complications for systematic theoretical analyses
iii jet algorithms must be fully understood as an instrument of physical measurement
an implication is that the analysis of measurement errors including fluctuations due to the statistical nature of quantum theory predictions most notably how such errors survive the jet algorithms based data processing must be a central issue to be addressed by the theory
this line of thought led me to investigate the following fundamental analogy length energy flow calorimetric detector ruler real number filling the empty slot was the key issue i was preoccupied with in
in the practical aspect ref
introduced i a large new class of generalized shape observables the so called c algebra some interpreted as integer jet numbers others so called spectral discriminators sensitive to the structure of multi jet substates
the motivation was to illustrate that jet algorithms are in principle not needed to extract the physical information usually obtained by their mediacy such information is best extracted using generalized shape observables this became a theorem in my second paper and finally that jet algorithms are from this viewpoint only a means for approximate construction of such observables
the notion of regularization of event cuts as an fective means to suppress statistical fluctuations induced in answers and thus enhance the signal background
ref
offered a more systematic treatment and provided new examples and prescriptions for regularizations
a binary recombination algorithm with an optimal recombination criterion which was derived uniquely from first principles within the assumption of the binary recombination scheme and which turned out to be a geometric mean of the jade and geneva criteria
the optimal criterion was generalized in into a global recombination scheme to become the optimal jet definition
in effect the paper introduced a novel systematic point of view on jet algorithms as a means of tion of observables for precision measurements it is in a sense purely kinematical in that it starts from the analysis of measurement errors and their evolution in data processing algorithms so that on the surface dynamical issues play a subordinate role see however the discussion in sec


after the paper was finished a well meaning theorist advised me that i should now do some data processing
the advice was ignored the complexity of the problem called for some division of labor i just did what i could in my situation and went to great sparing no to make my findings read by theorists and experimentalists alike
as a reward for all the agony not counting the damage my other projects suffered due to a few years neglect the paper earned me exactly three external citations
to the experimental one i ll turn in sec

of the other two one was an incorrect attempt to literally implement an ancillary interpretation quoted in a footnote of see for details
the other was a prominent but non specific citation in a review talk
behind the scenes there was among other things an earlier negative report on which expressed a conviction that kinematics is not what the theory of jet algorithms is about and that the qcd dynamics was the real issue
my reply systematically presented in was that it may not be healthy to proceed to the dessert of dynamics without first doing away with the soup of setting up the kinematics correctly
in fact there are two potentially conflicting issues which jet definition is best for theoretical calculations which jet algorithm is best for extracting maximum information from experimental data the theory of the popular kt algorithm simply misses b and settling on an ad algorithmic scheme successive binary recombinations focuses on a
on top of that convenience of theoretical calculations is judged from the standpoint of the sudakov lipatov method of leading logarithmic approximation
no expert in diagrammatics can fail to appreciate the beauty of sudakov s paper or to be frustrated at least at first by l
n
lipatov s calculational tornado yet to me the lla techniques is rather an antiquated piece there are much more powerful ways to handle diagrams
in short the argumentation behind the kt algorithm left me unimpressed
like spending a hours long birthday passing customs waiting for a delayed plane and flying non stop across the whole of europe the atlantic and a good part of usa all this heroism in order to drop the preprint right where the action was
the outrageously un academic but extremely effective graphic on the first page was employed only after testing its effect on a few unwary colleagues but what about
for convenience of discussion i divide the algorithms in the language of theory dynamics is nothing more than qualitative properties of qcd matrix elements
the most basic such property is the collinear singularities with the probability density behaving as q q d where q is the collinear angle of the emitted parton

the leading power behavior
is exactly what mines the specific form of the usual conditions of ir safety as explicitly formulated in
so making one s observables ir safe already includes the most important dynamical information into the picture
this is the case e

with ojd both the recombination version of and the global n part n jets variant of
if the collinear singularities were more severe e

then restrictions would have to be imposed not only q on the values of observables but also on their first derivatives and the entire theory together with the resulting ojd would have changed accordingly
compared with the leading power behavior mic corrections resummed or not play a dinate role this is particularly clear in the context of the theory which offers a constructive model for the notion of physical information of the event
so as no surprise comes the evidence see sec

that the behavior of various flavors of kt algorithm would differ from the binary version of ojd within the tainties of the kt type algorithms
moreover ref
contains an argument which strates that ojd is optimal not only in the kinematical sense but which was not a priori expected also in a properly formulated dynamical sense
this shows that the ir safety reflecting the singular structure
is all that really must be taken into account in the definition of jets anything on top of that is best treated as something only theorists should worry about in their calculations
this conclusion is corroborated by the findings of to which i now turn
comparison of different binary recombination algorithms
another theoretical paper which came to my attention recombination scheme after the completion of is the comparison of various versions of the iterative formed by acknowledged experts in such matters
the comparison contains a number of results which are visible confirmations of some a priori claims made in and for many such explicit calculations may be more convincing than the logical arguments
a question by s
catani at
a difficulty with synthetic solutions is that they often involve logical patterns which abstract experiences from other problem domains considered in into two groups the good rithms variations of the venerable and the kt and the bad algorithms jade and geneva
it was of course superfluous to include into parison the optimal criterion of because its behavior can be easily deduced from the results for the two bad algorithms
the latter fact being not mentioned in here are some comments
the optimal geneva and jade criteria have tively the following forms e a e a e e a b e b e e a e e e a b b q cos ab q cos q cos ab ab y cut y cut y cut



the optimal criterion happens to be a geometric mean of the other two
it is perfectly clear that its behavior should also be a median one
now the several graphs presented in e

figs

show that the behavior of jade is always the worst geneva behaves erratically and the good algorithms populate the band between jade and geneva
the band turns out to be pretty wide proving that the effect of what one expects to be insignificant algorithmic variations such as changes in the order of tions is large and not incomparable with the difference between the good and bad algorithms
it is also perfectly obvious that the optimal criterion is bound to be among the good algorithms
an tion is that its global analog the ojd must behave similarly to the good algorithms
now on to the experimental citation of
where such experiences may be common knowledge rather then the specific one being dealt with where such principles can be a novelty and as such are greeted with suspicion
note that the definition of luclus changed compared with the original the luclus is equivalent to the optimal criterion with the angular factor square rooted
the top signal in the all jets channel at recall that the two collaborations which reported the discovery of the top at fnal in cdf and were in very different positions cdf had the svx tagging hardware which proved to be a powerful means for selecting the events with top
in particular at the time of the top discovery in could not see the top signal in the all jets channel
so there was a strong competitive pressure on to seek alternative methods
the preprint release of could not be more timely
i d like to emphasize that the initial contact with physicists occurred at
another peculiar circumstance is that both physicists a
klatchko and d
stewart who are to be credited for bringing the new theory to the attention of the all jets team had to leave physics
at a
klatchko picked up a copy of my talk and brought it to fermilab
the copy was inherited by d
stewart
although about to leave physics too he made the effort of finding me at fermilab where i was able to visit thanks to a g
soros grant and the hospitality of fnal theorists showed me around the detector and brought me into contact with other members of the all jets group s
ahn and h
prosper and we had a nice long discussion about regularization of cuts and spectral discriminators
n
sotnikova a member of both and the qfthep team ensured that the draft of was well advertised and plentifully available at
the next time i heard about the all jets group was at from e
boos who mentioned some striking results but could not provide any details
i tried to get into contact with but failed
i heard nothing from them since then and switched to asymptotic expansions of feynman diagrams the subject neglected since in favor of jets until i ran across ref
while at cern in march
their page contains the following passage which i can not resist quoting additional cuts are applied to remove events with noise from the main ring
after these cuts about events remain
at this stage the signal to background ratio is about
requiring an slt tag increases the signal background by about an order of magnitude leaving events
to make further progress performs a multivariate analysis using thirteen variables described briefly in table
the principal ones are h h t t h t e t e t the average jet count an jets the aplanarity a the centrality c h t jets e jet m and the transverse momentum of the muon tp
a particularly powerful and unusual variable is the average jet count defined by n a jets gev gev e n e de t t t gev gev e de t t is the number of jets with transverse energy greater than te
this variable inspired by the work where of is interesting in that it assigns a nonintegral number of jets to the event
n e t these thirteen variables are combined using feed forward neural networks the final result of the procedure is observation of the excess of events containing top over background in the total cross section at the level of

to appreciate the work behind the observable note that it has no direct analog in
i can think of the following way to arrive at it
in the so called spectral discriminators were introduced which for narrow jets allowed representations s d s d w s s
j j where summation runs over all of the event and s j is a variable like invariant mass or transverse energy of the
this kind of observables are not usually considered and must have simply ignored what i wrote about how such observables can be defined bypassing jets and focused on the simplest case i
e
distribution of event s jets along the axis et and tried to see how the resulting patterns for background events and n e t top events differ
they might have replaced d with the equivalent integral quantities similarly to how this is done in the probability theory to avoid directly dealing with singular probability densities and then used event generators to study the corresponding patterns for background events and events with top to arrive at their observable see sec


at this point i can not help reminiscing how a nent qcd expert told me he d found ref
hensible apparently because there were in it no leading logarithms no parton distributions in short none of what qcd theorists swear by
another expert advised me that the things i discussed were not what experimentalists really needed
also shortly after the release of an american theorist p
ventured to run tests of spectral discriminators
despite obtaining tures which fully agreed with the qualitative expectations of p
strangely made an exactly opposite conclusion
my guess is he simply coded the formulae of as is without trying to understand their meaning and naively expected to see exactly the bumps i draw there
instead he saw a shoulder and a steeply rising background to the left of it
the presence of the shoulder was a clear cation that the signal was there and one only had to study its evolution and to figure out a simple way to extract the numerical information e

a wavelet filter would do nicely
but apparently there are easier ways for a theorist equipped with a computer and a mc generator to produce a publication than deep tation with novel ways to process data
for fairness sake the dominant software engineering platform in hep fortran c
does not encourage such experimentation
power of regularizations
an important trick in the construction of good observables is regularization
this is a concept widely used in applied mathematics see for references
in and i only gave simple examples to illustrate potential benefits of regularizations which by the way come in many flavors although with the same underlying principles
the above observable offers a great real world discovery class example of how useful a regularization can be
n c indeed suppose one has noticed that top events tend to produce more energetic jets
then one would consider the event has n jets with the observable gies above c with some c
an integer valued vable is discontinuous and its discontinuities are on general grounds sources of non optimality loss of physical information due to unnecessary enhancement of statistical fluctuations in the transition from raw data to the values of the observable see
such non lities are eliminated by introducing a continuous zation e

in the form of a smearing over the cut c
general principles do not fix details like the weight used for the smearing
at this point some experimentation is needed
finding an optimal shape of regularization ever is a much more specific task than the original one
note that the smearing as a way to regulate a hard cut was not explicitly mentioned in although smearings were mentioned in other contexts
a conclusion from the experience is as follows learn to use regularizations
optimal jet definition the final form the second part of the theory ref
improved upon the first in almost every point
i now had a proof that observables which yield the theoretically best precision for a particular parameter are always the generalized shape observables jets based observables can only yield approximations to such optimal observables
as a result the entire theory of jet algorithms now reduces to studying ways of construction of such approximations
it is this embedding of the problem of jet definition into a broader context which provides an unambiguous criterion for deciding which algorithm is best the best jet algorithm is that which allows one to construct the best observable for measurements of a given parameter the best observable is that which yields the best precision for the parameter
second i now derived the most general n part n jets recombination criterion for finding jets
the criterion required minimization of a multi axes generalization of the well known thrust
an e mail from w
giele about a forthcoming session of the jet definition working group at fnal in march stimulated exploration of algorithmic implementations of ojd resulting in an efficient code
third there were systematically motivated ways to treat the problem of non uniqueness of jet configurations via association of multiple appropriately weighted jet configurations with the same event
for details the reader is referred to
quasi optimal observables
pondering the observable one is faced with a natural question is there a way to obtain such particularly powerful observables in this and similar problems with less guesswork than had been involved in the finding of the answer is yes and the ponding prescriptions are called the theory of optimal observables
in view of its general importance it was posted separately rephrased in the jargon of parameter estimation of mathematical statistics
the theory is simple and closely related to the rao cramer inequality see or
quasi optimal observables are a means to approach the quality of the maximal likelihood method in tions where its application is problematic such as encountered in hep infinite dimensionality of the lying event space and a probability density in the form of event generator rather than an explicit formula
although maximal likelihood is widely used see e

the method of quasi optimal observables is simpler more flexible and offers new options both for design of general purpose software tools and for data processing in specific applications
for instance instead of the observable i would simply mc generate a quasi optimal observable in the jet dimensional space of the variables te e

using a rectangular grid the formal parameter to be estimated would be the coupling to produce top antitop pairs
if constructed with enough care such an observable might well obviate the need for neural networks
this would certainly be the case for a quasi optimal observable constructed for the variables including the six te plus all the variables from table which can not be expressed in terms of these
jet it would be interesting to develop universal adaptive software to automatically generate quasi optimal vables given a sample of events and a number of more or less variables
it looks like this could be done without recurring to fancy techniques such as neural networks
a practical conclusion is this learn to construct quasi optimal observables
unless i missed something in the top mass has not yet been measured in the all jets channel at
this could be an excellent starting point
the global n part n jets recombination algorithm
the derivation description and discussion can be found in
a convenient brief summary of the tion is given in
suffice it to say the following ojd prescribes to determine the jet configuration via minimization of shape observables which generalize the venerable thrust to n axes
ojd is similar to a cone in that there is a parameter r which limits the cone radius and the resulting cones are less irregular than with binary recombinations
being a global version of the binary recombination algorithm of its behavior and properties e

stability can only be better than for the binary recombination version which as we saw in sec

should be on a par with other good jet
the speed of jet search is expected to be o n o n part compared with the n behavior part jets of binary recombination schemes including k t this property alone might make ojd the jet algorithm of choice for future colliders such as lhc where plicities are much higher
ojd is intrinsically connected with the theory of i incorrectly stated in a talk that ojd is equivalent to a cone algorithm for events with well defined jets
however the cone radius in ojd depends on the distribution of energy around the jet axis so that the techniques of energy corrections developed for fixed cone algorithms would have to be modified
this has been confirmed in a number of un premeditated tests run on realistic mc event samples by pablo achard
in at least one graph i saw with my own eyes ojd resolved partons significantly better with an efficiency close to than kt in the entire interval of rapidities where both algorithms yielded meaningful results
quasi optimal observables
as a result ojd unlike binary recombination algorithms whether optimal or kt offers natural regularizations to solve such problems as the potential non uniqueness of jet configurations which reflects the fact that different parton configurations may generate the same hadronic final state
on the difficulty of computer implementation
from i learned that generalizations of thrust were proposed for jet definition in the early s
the exact form of ojd in particular the treatment of soft energy via an additive term could of course not have been guessed a priori
on the other hand ref
concluded that jet search based on optimization of like shape observables was computationally prohibitive
to this i note the following the code and data structures of the ojd tation described in take under k of ram for events and the algorithm finds jets for such an event in a fraction of a second on a modest pentium
such an algorithm could be implemented even on a pc with k of ram
what was lacking was not hardware or even software the old fortran iv not to say turbo pascal
would have been sufficient but expertise in numerical matics and software engineering as well as tion
determination could have only come from tion of the theoretical depths behind ojd
the software engineering aspect is discussed in the notes collected in
here i would only like to point out that the cement of fortran in favor of rather than strictly type safe languages such as any version of see e

in the physicists software engineering is a disaster of historic proportions and a good part of the explanation of inability of theorists to accomplish plete loop calculations for
it is also absolutely irrational in view of the existence of simple and powerful alternative in the form of the family of languages representing the brilliant tradition of design of n
wirth and his school starting from the old pascal see for more on this
the harnessing of the digital revolution being a major infrastructure problem in physics as elsewhere a petent and responsible policy of steering the hep munity towards the use of safe programming languages and redirecting human energy released thereby into more productive activities than debugging codes would have a major positive impact on physics
for the events tested by pablo achard the ojd tation of was somewhat slower but not significantly than kt
note that ref
focused on feasibility studies and did not attempt to implement all possible algorithmic optimizations
conclusions appendix
the benefits of ojd compared with kt
all the qcd argumentation behind kt boils down in the end to the proposition that with it better theoretical calculations are possible
however experimental data are more valuable than theoretical numbers preserving information from data is more important than making it easier for theorists to do their calculations
ojd is optimal precisely because it preserves the experimental information in the best manner possible
as regards calculations nothing compares with shape observables such as thrust in regard of calculability lla or nlla and amenability to theoretical analyses power corrections and ojd is based on such observables
furthermore there are better ways to do complex calculations than the archaic lipatov sudakov techniques namely the systematic machinery of asymptotic operation whose euclidean version remember is behind most of the well known nnlo calculations in qcd
further the binary recombination scheme per is flawed
the large variations between different variants of good recombination criteria
the kt algorithm behaves quadratically in the number of particles and ojd may run faster for lhc cities
ojd offers new options for a systematic construction of better observables options not available within any conventional jet definition schemes
to the best of my understanding the subject of jet definition as a theoretical problem is closed
the most important next task in regard of jet related data processing appears to be for physicists to learn to use ojd for construction of quasi optimal observables for specific applications
psychologically the main difficulty may be to stop wasting human effort and other valuable resources on the obsolete jet definitions
acknowledgments this work was supported in part by the russian dation for basic research quantum field theory under grant
i am grateful to v
von schlippe for a comment and to s
karshenboim for suggesting a term
finally it is my greatest pleasure to thank the zers of the qfthep workshops e
e
boos b
b tchenko v
i
savrin and n
a
sveshnikov for their invariable support over all these years
there is far too much to my taste of this sort of things that goes unrecorded so here is my contribution in when the above fnal report was released the hep section of the russian foundation for basic research denied me support for my projects
if the support were not resumed by the quantum field theory section and no jets were not even mentioned in my grant application you would most certainly not learn about ojd
this must have something to do as i realize post factum with the old story of landau vs
bogolyubov reflected within the russian theoretical physics in the form of a certain gruppovschina with the two sections of rfbr influenced by the respective theoretical schools
i do not see what i personally have to do with that old story except a sufficient mathematical background to have drifted in my years of innocence to bogolyubov s cathedra i do own a complete set of the landau and lifshits textbooks too
for fairness sake the fundamental reason for that bitter controversy lied not so much in particular personalities the mistake usually made but in the overcentralization of everything in russia so that the entire hierarchy is affected by idiosyncrasies of the individuals at the top multiplied by the centuries old tradition of servility of subordinates
there is an objective tendency for similar effects to occur wherever individuals are endowed with considerable administrative powers germany comes to mind with perhaps servility replaced by discipline and wherever resource allocation politics finds fertile soil in complex hierarchies within which there often are no efficient checks to deter individuals from irresponsibility in spreading their necessarily somewhat subjective opinions
i wish i could benefit from even a tiny fraction of the funds used up by the two jet definition working groups fnal and des houches which operated during while the work on the final version of and on the software implementation of ojd was in progress a mere
would have been enough for a mighty upgrade of my computers
it is rather a paradox given the state of physics in russia that up to this point the work on the theory of jets and ojd was performed as a kind of charity for the international hep community
references f
v
tkachov calorimetric measurements and jet counting zvenigorod russia sept
ed
b
levtchenko inp msu moscow
algebraic algorithms for multiloop calculations
the first years
what next hep nuima
f
v
tkachov optimizing computations of jet f
v
tkachov on the operator product expansion in the discriminators zvenigorod russia sept
ed
b
levtchenko inp msu moscow
f
v
tkachov from jet algorithms to c algebra
measurement errors and regularization of cuts zvenigorod russia sept
ed
b
levtchenko inp msu moscow
f
v
tkachov status of the theory of jet observables talk at samara russia sept

d
y
grigoriev and f
v
tkachov an efficient implementation of the optimal jet definition hep moscow may june
eds
b
levtchenko and v
savrin inp msu moscow
f
v
tkachov measuring the number of hadronic jets hep phys
rev
lett
errata ibid

ms scheme phys
lett
advanced methods for studying radiative corrections
theory of asymptotic operation hep phys
part
nucl

jade collaboration w
bartel et al
z
phys

s
bethke z
kunszt d
e
soper and w
j
stirling new jet cluster algorithms next to leading order qcd and dronization corrections nucl
phys

g
sterman recent progress in qcd hep talk at aps meeting of division of particles and fields dpf los angeles ca jan

s
catani y
l
dokshitzer m
olsson g
turnock and b
r
webber new clustering algorithm for multijet cross sections in annihilation phys
lett

f
v
tkachov measuring multijet structure of hadronic v
v
sudakov vertex parts at very high energies in energy flow or what is a jet hep lab t int
j
mod
phys

quantum electrodynamics sov
phys
jetp
n
a
sveshnikov and f
v
tkachov jets and quantum f
v
tkachov towards systematic near threshold field theory hep phys
lett

f
v
tkachov a theory of jet definition hep revised jan

p
c
bhat h
prosper and s
s
snyder top quark physics at the tevatron hep int
j
mod
phys

f
v
tkachov approaching the parameter estimation quality of maximum likelihood via generalized moments
g
sterman and s
weinberg jets from quantum chromodynamics phys
rev
lett

oberon microsystems inc

oberon
ch

inr
ac
projects jets index
htm
f
v
tkachov talk the cern theory div
seminar march
f
v
tkachov a theorem on analytical calculability of loop renormalization group functions phys
lett
expansions in perturbative qft hep phys
lett
distribution theoretic methods in quantum field theory hep talk at the bogolyubov conf
moscow dubna kyiv sept
oct

g
sterman mass divergences in annihilation processes
i
origin and nature of divergences in cut vacuum polarization diagrams phys
rev

s
moretti l
lonnblad and t
sjostrand new and old jet clustering algorithms for electron positron events jhep
t
sjstrand comp
phys
comm

pablo

ch
j
b
babcock and r
e
cutkosky identification of jets nucl
phys

f
v
tkachov theoretical physicist s personal software engineering in the post java world to be posted

